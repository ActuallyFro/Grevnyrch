<!-- This form enables rapid creation of GLS-compliant Logs  -->
<!-- Source: https://www.w3schools.com/js/tryit.asp?filename=try_dom_select_option -->

<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- https://getbootstrap.com/docs/5.2/getting-started/introduction/ -->
  <title>GLSL</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

  <!-- 
    Separate Popper & JS:
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js" integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js" integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK" crossorigin="anonymous"></script> -->

<script>
  // Global var to store the propsed ledger entry, as array of strings
  var isLedgerEmpty = true;
  var isLogEmpty = true;
  var oldLedger = [];
  var Log = [];

var brackets = [
  ["༺ ༻", "Realm", "Locations"],
  ["〖 〗", "City", "Locations"],
  ["《 》", "District", "Locations"],
  ["⟅ ⟆", "Round", "Timing"],
  ["⧼ ⧽", "Time/Duration", "Timing"],
  ["[ ]", "PC or NPC", "PC or NPC Level Actions"],
  ["] [", "Hostile NPC/encounter (Single)", "PC or NPC Level Actions"],
  ["⟦ ⟧", "Grouping of PCs/NPC", "PC or NPC Level Actions"],
  ["⟧ ⟦", "Grouping of Hostile NPCs/encounter", "PC or NPC Level Actions"],
  ["( )", "Action", "PC or NPC Level Actions"],
  ["< >", "Movement", "PC or NPC Level Actions"],
  ["⸢ ⸣", "Right hand", "PC or NPC Level Actions"],
  ["⸤ ⸥", "Left hand", "PC or NPC Level Actions"],
  ["⸢ ⸥", "Both hands/two handed", "PC or NPC Level Actions"],
  ["⦇ ⦈", "Armor class", "PC or NPC Level Actions"],
  ["⟮ ⟯", "Dice Roll Success (check)", "PC or NPC Level Actions"],
  ["⟯ ⟮", "Dice Roll Success (check)", "PC or NPC Level Actions"],
  ["⧘ ⧙", "Damage Amount", "PC or NPC Level Actions"]
];

  // Generate default brackets
  window.onload = function() {
    // document.getElementById("bracket").innerHTML = "<option value=\"༺༻\">Realm: ༺ ༻</option><option value=\"〖〗\">City: 〖 〗</option><option value=\"《》\">District: 《 》</option><option value=\"〈〉\">Location: 〈 〉</option><option value=\"⟅⟆\">Round: ⟅ ⟆</option>";

    //generate option tags from brackets array
    for (var i = 0; i < brackets.length; i++) {
      var option = document.createElement("option");
      option.value = brackets[i][0];
      option.text = brackets[i][1] + ": " + brackets[i][0];
      document.getElementById("bracket").appendChild(option);
    }
  }

  function LedgerIt() {
    var obj = document.getElementById("bracket");
    oldLedger.push(document.getElementById("ledger").innerHTML);
    var tempBracket = obj.options[obj.selectedIndex].value;
    var tempTarget = document.getElementById("target").value;

    if (isLedgerEmpty){
      document.getElementById("ledger").innerHTML = tempBracket.slice(0,1) + tempTarget + tempBracket.slice(-1,tempBracket.length);
      isLedgerEmpty = false;

    } else {
      document.getElementById("ledger").innerHTML += tempBracket.slice(0,1) + tempTarget + tempBracket.slice(-1,tempBracket.length);
    }
  }
   
  function LogIt() {
    var obj = document.getElementById("ledger");
    var currentLedger = document.getElementById("ledger").innerHTML;
    Log.push(currentLedger);

    if (isLedgerEmpty){
      return;
    }

    if (isLogEmpty){
      document.getElementById("log").innerHTML = currentLedger + "<br>";
      isLogEmpty = false;
    } else {
      document.getElementById("log").innerHTML += currentLedger + "<br>";
    }
    ClearLedger();

  }

  function RemoveLastLog() {
    Log.pop();
    document.getElementById("log").innerHTML = "";
    if (Log.length > 0){
      for (var i = 0; i < Log.length; i++) {
        document.getElementById("log").innerHTML += Log[i] + "<br>";
      }

    } else {
      ClearLog();
    }

  }

  function ClearLedger() {
    isLedgerEmpty = true;
    document.getElementById("ledger").innerHTML = "<h2><i>{Ledger is empty}</i></h2>";
    oldLedger = [];
  }

  function ClearLog() {
    isLogEmpty = true;
    document.getElementById("log").innerHTML = "<h2><i>{Logs are empty}</i></h2>";
    Log = [];
  }

  function UndoLedger() {
    if (oldLedger.length > 0) {
      document.getElementById("ledger").innerHTML = oldLedger[oldLedger.length-1];
      oldLedger.pop();  

    } else {
      ClearLedger();
    }
  }

</script>
</head>
<body>

<!-- bootstrap form -->
<div class="container">
  <div class="row">
    <div class="col-sm-12">
      <form>

        <label for="target">Target</label>
        <input type="text" list="targets" id="target" name="target" placeholder="Inner-bracket target/content"/>
        <datalist id="targets">
          <option>Grevnyrch</option>
          <option>Kla'Bbbert</option>
        </datalist>
        <br>

        Select your tag:
        <select id="bracket">
        </select>

        <select id="operator">
        <option></option>
        <option>Act upon: →</option>
        <option>Add to symbol table: ;;</option>
        </select>

        <br><br>

        <input type="button" onclick="LedgerIt()" value="Ledger It!">
        <input type="button" onclick="LogIt()" value="LogIt!">
        <input type="button" onclick="ClearLedger()" value="Reset">
        <input type="button" onclick="UndoLedger()" value="Undo">
      </form>    
    


      <div id="ledger" style="background-color:rgba(72, 72, 255, 0.571);">
        <h2><i>{Ledger is empty}</i></h2>
      </div>

      <br><br>

      <div id="log" style="background-color:rgba(178, 178, 188, 0.571);">
        <h2><i>{Logs are empty}</i></h2>
      </div>



      <p id="Logs"></p>
      <form>
        <input type="button" onclick="RemoveLastLog()" value="Remove Last Log">
        <input type="button" onclick="ClearLog()" value="Clear Log">
      </form>

    </div>
  </div>
</div>

</body>
</html>

